# Topics Feature Implementation Plan

## Overview

Implement topic-based landing pages that group curated, age-appropriate words into stable categories. Each topic page serves as a discoverable entry point for parents, provides meaningful descriptive content for indexing, and starts a self-contained, multi-turn game session without relying on the LLM.

---

## Phase 1: Topic Data Layer

### 1.1 Define Topic Schema

- [ ] Create `lib/topics/schema.ts` with Zod schema:
  ```ts
  {
    id: string,              // URL slug (e.g., "animals")
    name: string,            // Display name (e.g., "Animals")
    description: string,     // SEO description (2-3 sentences)
    learningGoals: string[], // Educational objectives
    icon: string,            // Emoji icon for display
    level: 1 | 2 | 3,        // Age-based difficulty level
    words: string[],         // Curated word list
  }
  ```

### 1.2 Define Levels

- [ ] Create level definitions in `lib/topics/levels.ts`:

  | Level | Name       | Age       | Focus                                       |
  | ----- | ---------- | --------- | ------------------------------------------- |
  | 1     | Explorer   | 1-2 years | Naming concrete, everyday objects           |
  | 2     | Discoverer | 3-5 years | Categorization, basic logic, emotions       |
  | 3     | Scholar    | >5 years  | Complex symbols, global awareness, abstract |

### 1.3 Create Initial Topics

- [ ] Create `lib/topics/data.ts` with curated word lists per topic:

  **Level 1: Explorer (1-2 years)** - Concrete, everyday objects

  | Topic          | Words                                                                             |
  | -------------- | --------------------------------------------------------------------------------- |
  | Animal Friends | dog, cat, pig, cow, chicken, duck, horse, sheep, rabbit, fish                     |
  | Fruits         | apple, banana, strawberry, orange, grapes, watermelon, lemon, pear, peach, cherry |
  | Vehicles       | car, bus, train, truck, plane, boat, bicycle, helicopter, motorcycle, tractor     |
  | Clothing       | shoe, t-shirt, hat, pants, dress, sock, coat, gloves, scarf, boots                |
  | Colors         | red, blue, green, yellow, orange, purple, pink, brown, black, white               |

  **Level 2: Discoverer (3-5 years)** - Categorization, emotions, attributes

  | Topic        | Words                                                                                                                               |
  | ------------ | ----------------------------------------------------------------------------------------------------------------------------------- |
  | Wild Animals | lion, elephant, giraffe, zebra, monkey, bear, shark, dolphin, butterfly, octopus, penguin, kangaroo                                 |
  | Food         | pizza, ice cream, hamburger, donut, popcorn, cake, cookie, bread, cheese, egg, rice, noodles                                        |
  | Nature       | sun, rain, rainbow, cloud, snow, star, moon, rose, sunflower, tree, mushroom, clover, mountain, volcano, beach, wave, fire, snowman |
  | Emotions     | happy, sad, angry, scared, surprised, sleepy, love, sick, cool, crying                                                              |
  | Shapes       | circle, square, triangle, star, heart, diamond                                                                                      |

  **Level 3: Scholar (>5 years)** - Complex symbols, global awareness

  | Topic        | Words                                                                                              |
  | ------------ | -------------------------------------------------------------------------------------------------- |
  | Flags        | USA, Japan, Brazil, France, UK, Germany, Italy, Canada, Australia, Mexico, China, India            |
  | Celebrations | birthday, christmas, halloween, fireworks, party, gift, balloon, confetti, cake, sparkler          |
  | Sports       | soccer, basketball, tennis, golf, skiing, baseball, american football, volleyball, hockey, bowling |
  | Professions  | doctor, cook, artist, pilot, teacher, firefighter, police, farmer, scientist, astronaut            |
  - `symbols` (overlap with shapes)

### 1.4 Topic Utilities

- [ ] Create `lib/topics/index.ts` with functions:
  - `getAllTopics()` - return all topics
  - `getTopicById(id)` - get single topic by slug
  - `getTopicsByLevel(level)` - return topics for a specific level
  - `getRandomWordsFromTopic(topicId, count)` - get N random words for game session

---

## Phase 2: Topic Routes

### 2.1 Topics Index Page (`/topics`)

- [ ] Create `app/topics/page.tsx`:
  - Server component
  - **Sections by level** (Explorer → Discoverer → Scholar)
  - Each section has heading with level name, age range, emoji icon
  - Grid of topic cards within each section
  - Each card shows: icon, name, description snippet
  - Responsive layout (2 cols mobile, 3-4 cols desktop)
  - Level info NOT repeated on individual topic detail pages

### 2.2 Topic Detail Page (`/topics/[topicId]`)

- [ ] Create `app/topics/[topicId]/page.tsx`:
  - Server component with `generateStaticParams()` for static generation
  - Topic header: icon, name (no level/age - shown on index only)
  - Learning goals section
  - Full description paragraph
  - "Start Playing" button to begin session
  - Word preview (sample of 5-6 words as chips)

### 2.3 Topic Game Session (`/topics/[topicId]/play`)

- [ ] Create `app/topics/[topicId]/play/page.tsx`:
  - Server component that initializes 10-word session
  - Select 10 random words from topic's word list
  - Pre-generate all game content using `generateLocalContent()`
  - Pass pre-computed data to client component

### 2.4 Topic Session Client

- [ ] Create `app/topics/[topicId]/play/session.tsx`:
  - Client component for multi-turn gameplay
  - State: current round (1-10), score, items per round
  - Reuse existing `GameScreen` component
  - After each correct answer, advance to next round
  - After 10 rounds, show session summary

---

## Phase 3: Session Management

### 3.1 Session Data Structure

- [ ] Define session schema in `lib/topics/session.ts`:
  ```ts
  {
    topicId: string,
    rounds: {
      word: string,
      type: "color" | "emoji",
      targetValue: string,
      distractors: [string, string],
    }[],
    currentRound: number,
    correctCount: number,
  }
  ```

### 3.2 Server-Side Session Generation

- [ ] Create `generateTopicSession(topicId)` function:
  - Get 10 random words from topic
  - Call `generateLocalContent()` for each word
  - Return fully pre-computed session data
  - Handle words not in local database (skip or fallback)

### 3.3 Session Progress Component

- [ ] Create `components/SessionProgress.tsx`:
  - Visual progress indicator (10 dots/circles)
  - Current round highlighted
  - Completed rounds shown as filled/green
  - Responsive sizing

### 3.4 Session Summary Screen

- [ ] Create `components/SessionSummary.tsx`:
  - Score display (X out of 10)
  - Celebration animation (reuse Confetti)
  - "Play Again" button (restart same topic)
  - "Try Another Topic" button (return to topics index)
  - Share capability (optional)

---

## Phase 4: Home Page Updates

### 4.1 Featured Topics Section

- [ ] Add topics section to `app/page.tsx`:
  - "Choose a Topic" heading
  - Grid of 4-6 featured topic cards
  - "See All Topics" link to `/topics`
  - Position above or alongside current input

### 4.2 Navigation Flow Update

- [ ] Update home page layout:
  - Keep existing word input as secondary option
  - Topics as primary, visually prominent path
  - Clear visual hierarchy

### 4.3 Shared Topic Card Component

- [ ] Create `components/TopicCard.tsx`:
  - Reusable across home page and topics index
  - Props: topic data, size variant (compact/full)
  - Consistent styling with app theme

---

## Phase 5: SEO & Discoverability

### 5.1 Metadata for Topic Pages

- [ ] Add `generateMetadata()` to topic routes:
  - Dynamic title: "Learn {Topic} - Find It!"
  - Description from topic data
  - Open Graph tags for social sharing
  - Canonical URLs

### 5.2 Sitemap Generation

- [ ] Create `app/sitemap.ts`:
  - Export `sitemap()` function for Next.js
  - Include home page, topics index
  - Include all individual topic pages
  - Set appropriate priorities and changefreq

### 5.3 Structured Data

- [ ] Add JSON-LD structured data to topic pages:
  - `EducationalOccupationalProgram` or `WebApplication` schema
  - Age range, learning objectives
  - Helps AI systems understand content

### 5.4 Internal Linking

- [ ] Cross-link between topics where relevant
- [ ] Link from success screen to related topics
- [ ] Breadcrumb navigation on topic pages

---

## Phase 6: Polish & Testing

### 6.1 Loading States

- [ ] Add loading UI for topics index
- [ ] Add loading UI for topic detail page
- [ ] Skeleton components for cards

### 6.2 Error Handling

- [ ] 404 handling for invalid topic IDs
- [ ] Graceful fallback if word content generation fails
- [ ] User-friendly error messages

### 6.3 Testing

- [ ] Unit tests for topic utilities (`lib/topics/`)
- [ ] Test session generation with edge cases
- [ ] Test metadata generation
- [ ] Verify sitemap output

### 6.4 Accessibility

- [ ] Ensure topic cards are keyboard navigable
- [ ] Add ARIA labels to progress indicators
- [ ] Screen reader support for session summary

---

## Decisions

| Topic                     | Decision                                                  |
| ------------------------- | --------------------------------------------------------- |
| Session length            | 10 turns per session (configurable later)                 |
| Word list source          | Curated word lists per topic (full control, no filtering) |
| LLM usage                 | None for topic sessions (local-only)                      |
| Session persistence       | None (stateless, no saving/resuming)                      |
| Scoring                   | Track correct count, no penalties for wrong attempts      |
| Word fallback             | Skip words not in local database (don't break session)    |
| Static generation         | Yes, all topic pages pre-rendered at build time           |
| `/find/:word` coexistence | Keep for ad-hoc use, topics are primary indexed surface   |

---

## File Structure

```
app/
  topics/
    page.tsx                    # Topics index
    [topicId]/
      page.tsx                  # Topic detail
      play/
        page.tsx                # Session initialization (server)
        session.tsx             # Session gameplay (client)
  sitemap.ts                    # Sitemap generation

components/
  TopicCard.tsx                 # Reusable topic card
  SessionProgress.tsx           # Round progress indicator
  SessionSummary.tsx            # End-of-session screen

lib/
  topics/
    schema.ts                   # Zod schemas
    levels.ts                   # Level definitions (Explorer, Discoverer, Scholar)
    data.ts                     # Topic metadata + curated word lists
    index.ts                    # Topic utilities
    session.ts                  # Session generation
    topics.test.ts              # Unit tests
```

---

## Dependencies

No new dependencies required. Uses existing:

- `next` (routing, metadata, sitemap)
- `zod` (schema validation)
- `lucide-react` (icons)

---

## Phase Summary

| Phase | Description           | Key Deliverables                                   |
| ----- | --------------------- | -------------------------------------------------- |
| 1     | Topic Data Layer      | Schema, levels, curated word lists, utilities      |
| 2     | Topic Routes          | Index (by level sections), detail page, play route |
| 3     | Session Management    | Multi-turn gameplay, progress, summary             |
| 4     | Home Page Updates     | Featured topics, navigation flow                   |
| 5     | SEO & Discoverability | Metadata, sitemap, structured data                 |
| 6     | Polish & Testing      | Loading states, errors, tests, a11y                |
